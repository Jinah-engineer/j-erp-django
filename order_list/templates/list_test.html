{# ---------- 박진아 작업 ---------- #}

{% extends "base.html" %}
{% load static %}
{% block stylesheets %}
    <style>
        #bootstrap-table {
            overflow-x: scroll;
            overflow-y: scroll;
            display: block;
            white-space: nowrap;
            table-layout:fixed;

        {#width: auto;#}
        }
        tbody {
            overflow-y: auto;
        }
        th, td{ text-align: center; }

        th {
            font-weight: bold;
        }
        td{
            overflow:hidden;
            text-overflow: ellipsis;
        }
        table.dataTable tbody tr.selected {
            color: white;
            background-color: cornflowerblue;
        }

        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        select {
            min-width: 150px;
            width: auto;
            height: 10px;
        }
        .badge{
            font-size: 1rem;
            margin: 0;
        }
        .dropdown-menu > li > a:hover, .dropdown-menu > li > a:focus {
            background-image:none !important;
        }
        .dropdown-menu > li > a:hover, .dropdown-menu > li > a:focus {
            background-color:pink;
        }
        .card {
            margin: 0 auto; /* Added */
            float: none; /* Added */
            margin-bottom: 10px; /* Added */
        }
    </style>
{% endblock stylesheets %}

{% block body %}

    <!-- *** 사이드 내비게이션 바 -->
    {% include 'navigation.html' %}

    <div class="main">

        <!-- *** 상위 내비게이션 바 *** -->
        {% include 'top-navigation.html' %}

        <main class="content">
            <div class="container-fluid">

                <div class="header">
                    <h1 class="header-title" style="font-family: 'NanumSquareEB'">
                        주문 목록
                    </h1>
                    <p class="header-subtitle" style="font-family: 'NanumSquareR'; font-size: 15px;">main</p>
                </div>

                <!-- *** 검색 바 *** -->
                {% include 'search_bar.html' %}

                <!-- *** 버튼 바 *** -->
                <div class="row">
                    <div class="col-12">
                        <div class="card" style="height: 50px;">
                            <div class="card-body">
                                <div class="row">
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button class="btn btn-success">주문 목록 인쇄</button>
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button class="btn btn-success get-excel-file" tabindex="0"
                                                aria-controls="bootstrap-table" title="Excel" id="get-excel-file">Excel 업로드</button>
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center get-excel" role="group" style="padding: 0 2px;">
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button class="btn btn-success">개별 주문장 출력</button>
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button class="btn btn-success">주문 수정</button>
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button class="btn btn-success">주문 삭제</button>
                                    </div>
                                    <div class="btn-group drop-end mb-4 align-items-center mr-auto" role="group" style="padding: 0 2px;">
                                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                            상태변경
                                        </button>
                                        <div class="dropdown-menu">
                                            <a type="button" class="dropdown-item" href="#">제작완료</a>
                                            <a type="button" class="dropdown-item" href="#">출고완료</a>
                                            <div class="dropdown-divider"></div>
                                            <a type="button" class="dropdown-item" href="#">출고보류</a>
                                            <a type="button" class="dropdown-item" href="#">출고취소</a>
                                            <a type="button" class="dropdown-item" href="#">기타</a>
                                        </div>
                                    </div>
                                    <div class="btn-group btn-group mb-4 align-items-center" role="group" style="padding: 0 2px;">
                                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                            정렬
                                        </button>
                                        <div class="dropdown-menu">
                                            <a class="dropdown-item" href="#">10개씩</a>
                                            <a class="dropdown-item" href="#">50개씩</a>
                                            <a class="dropdown-item" href="#">100개씩</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="col-12 d-flex">
                        <div class="card flex-fill">
                            <div class="card-header">
                                <div class="card-actions float-right">
                                    <a href="#" class="mr-1">
                                        <i class="align-middle" data-feather="refresh-cw"></i>
                                    </a>
                                    <div class="d-inline-block dropdown show">
                                        <a href="#" data-toggle="dropdown" data-display="static">
                                            <i class="align-middle" data-feather="more-vertical"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a class="dropdown-item" href="#">Action</a>
                                            <a class="dropdown-item" href="#">Another action</a>
                                            <a class="dropdown-item" href="#">Something else here</a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- *** Bootstrap 테이블 *** -->

                            <div class="col-12" style="padding: 0">
                                <div class="card w-100" style="">
                                    <table class="table table-bordered table-intel table-md cell-border"
                                           id="bootstrap-table"
                                           style="table-layout: fixed; width: 100%; height: auto; min-height: 400px;">
                                        <thead>
                                        <tr style="font-family: 'NanumSquareL';"
                                            onmousedown="return false" onselect="return true" onmouseup="return true">
                                            <th class="filters" data-sortable="true" id="th-pno" hidden="hidden">pno</th>
                                            <th class="filters" data-sortable="true" id="th-order_no" style="">
                                                주문 No.
                                            </th>
                                            <th class="filters" data-sortable="true" id="th-order_date" style="">주문일자</th>
                                            <th id="th-state" class="filters" data-sortable="true" style="">진행상태</th>
                                            <th class="filters" data-sortable="true" id="th-customer">고객명</th>
                                            <th class="filters" data-sortable="true" id="th-product_name">품목</th>
                                            <th class="filters" data-sortable="true" id="th-size_option_name">사이즈</th>
                                            <th class="filters" data-sortable="true" id="th-sheet_option_name">시트</th>
                                            <th class="filters" data-sortable="true" id="th-filling_option_name">필링</th>
                                            <th class="filters" data-sortable="true" id="th-boxing_option_name">포장</th>
                                            <th class="filters" data-sortable="true" id="th-phrase_option_name">문구</th>
                                            <th class="filters" data-sortable="true" id="th-count">수량</th>
                                            <th class="filters" data-sortable="true" id="th-total_price">금액</th>
                                            <th class="filters" data-sortable="true" id="th-order_type_name">주문경로</th>
                                            <th class="filters" data-sortable="true" id="th-pay_type_name">결제방법</th>
                                            <th class="filters" data-sortable="true" id="th-pay_check">결제여부</th>
                                            <th class="filters" data-sortable="true" id="th-recipient">수령인</th>
                                            <th class="filters" data-sortable="true" id="th-recipient_phone">연락처</th>
                                            <th class="filters" data-sortable="true" id="th-delivery_option_name">수령방법</th>
                                            <th class="filters" data-sortable="true" id="th-address1">수령주소</th>
                                            <th class="filters" data-sortable="true" id="th-address2">상세주소</th>
                                            <th class="filters" data-sortable="true" id="th-recipient_date">납품일자</th>
                                            <th class="filters" data-sortable="true" id="th-recipient_hour">납품시간</th>
                                            <th class="filters" data-sortable="true" id="th-memo">주문메모</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for order in orderDetail %}
                                            <!-- *** 주문 목록 테이블 상세 *** -->
                                            <tr style="display: table-row; border-color: darkgrey" id="order{{ order.order_no }}">
                                                <td hidden="hidden"><input hidden="hidden" name="pno" id="pno{{ order.pno }}" type="text" value="{{ order.pno }}"></td>
                                                <td style="padding: 0">
                                                    <button type="button" id="modal{{ order.pno }}"
                                                            class="btn btn-sm btn-primary order_no" data-toggle="modal" data-target="#sizedModalLg{{ order.pno }}"
                                                            style="color: dodgerblue; margin: 0; background-color: white; border-color: white; font-size: 12px; padding: 0"
                                                            value="{{ order.order_no }}">
                                                        {{ order.order_no }}
                                                    </button>
                                                </td>
                                                <td id="data-order-date" >{{ order.order_date }}</td>
                                                {% if order.state == order_completed  %}
                                                    <td style="padding: 0"><span id="order_state" class="badge badge-warning">{{ order.state }}</span></td>
                                                {% endif %}
                                                {% if order.state == production_completed  %}
                                                    <td style="padding: 0"><span id="order_state" class="badge badge-success">{{ order.state }}</span></td>
                                                {% endif %}
                                                {% if order.state == release_completed  %}
                                                    <td style="padding: 0"><span id="order_state" class="badge badge-primary">{{ order.state }}</span></td>
                                                {% endif %}
                                                <td>{{ order.customer }}</td>
                                                <td>{{ order.product_name }}</td>
                                                <td>{{ order.size_option_name }}</td>
                                                <td>{{ order.sheet_option_name }}</td>
                                                <td>{{ order.filling_option_name }}</td>
                                                <td>{{ order.boxing_option_name }}</td>
                                                <td>{{ order.phrase }}</td>
                                                <td>{{ order.count }}</td>
                                                <td>{{ order.total_price }}</td>
                                                <td>{{ order.order_type_name }}</td>
                                                <td>{{ order.pay_type_name }}</td>
                                                <td>{{ order.pay_check }}</td>
                                                <td>{{ order.recipient }}</td>
                                                <td>{{ order.recipient_phone }}</td>
                                                <td>{{ order.delivery_option_name }}</td>
                                                <td>{{ order.address1 }}</td>
                                                <td>{{ order.address2 }}</td>
                                                <td>{{ order.receipt_date }}</td>
                                                <td>{{ order.receipt_hour }}:00</td>
                                                <td>{{ order.memo }}</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- *** 주문 상세 모달 *** -->
        <!-- 주문 상세/수정 modal -->
        {#        <button type="button" id="modal{{ order.pno }}" class="btn btn-primary" data-toggle="modal" data-target="#sizedModalLg{{ order.pno }}">#}
        {#            주문 상세 테스트 Modal#}
        {#        </button>#}
        {% for order in orderDetail %}
            <div class="modal fade" id="sizedModalLg{{ order.pno }}" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 style="font-family: 'NanumSquareEB;" class="modal-title">{{ order.customer }}님의 주문 내역</h2>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body m-3">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card">
                                        <div class="card-body">
                                            <form action="" method="get">
                                                <!-- 주문 접수자 / 주문번호 / 주문일자 / 주문경로 -->
                                                <input type="text" id="pno{{ order.pno }}" name="pno" value="{{ order.pno }}">
                                                <div class="form-row">
                                                    <div class="form-group col-md-2">
                                                        <label for="">주문 접수자</label>
                                                        <button style="border: none; background-color: transparent" id="">
                                                            <i class="align-middle mr-2 fas fa-fw fa-user-friends"></i>
                                                        </button>
                                                        <input type="text" class="form-control" name="employee_name" value="{{ order.employee_name }}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="">주문 No.</label>
                                                        <input type="text" class="form-control" id="" value="{{ order.order_no }}">
                                                    </div>
                                                    <div class="form-group col-md-4">
                                                        <label for="">주문일자</label>
                                                        <button style="border: none; background-color: transparent" id="select-order-person2">
                                                            <i class="align-middle mr-2 far fa-fw fa-calendar-alt"></i>
                                                        </button>
                                                        <input type="text" class="form-control" id="" value="{{ order.order_date }}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="order-root">주문 경로</label>
                                                        <select class="form-control select1" data-toggle="select1">
                                                            {% for order_type in order_type_table %}
                                                                {% if order_type.order_type_name == order.order_type_name %}
                                                                    <option value="{{ order_type.order_type_name }}" selected>{{ order.order_type_name }}</option>
                                                                {% else %}
                                                                    <option value="{{ order_type.order_type_name }}">{{ order_type.order_type_name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>

                                                <!-- 고객명 / 연락처 / 수령방법 / 납품일자 / 도착시간 -->
                                                <div class="form-row">
                                                    <div class="form-group col-md-2">
                                                        <label for="inputCity">고객명</label>
                                                        <input type="text" class="form-control" name="" value="{{ order.customer }}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="inputCity">연락처</label>
                                                        <input type="text" class="form-control" value="{{ order.customer_phone }}">
                                                    </div>
                                                    <div class="form-group col-md-2">
                                                        <label for="order-root">수령방법</label>
                                                        {#                                                        <input type="text" class="form-control" value="{{ order.delivery_option_name }}" readonly>#}
                                                        <select class="form-control select1" data-toggle="select1">
                                                            {% for delivery in delivery_table %}
                                                                {% if delivery.delivery_name == order.delivery_option_name %}
                                                                    <option value="{{ delivery.delivery_name }}" selected>{{ order.delivery_option_name }}</option>
                                                                {% else %}
                                                                    <option value="{{ delivery.delivery_name}}">{{ delivery.delivery_name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="inputCity">납품일자</label>
                                                        <button style="border: none; background-color: transparent" id="select-order-person">
                                                            <i class="align-middle mr-2 far fa-fw fa-calendar-alt"></i>
                                                        </button>
                                                        <input type="text" class="form-control" id="" value="{{ order.receipt_date }}">
                                                    </div>
                                                    <div class="form-group col-md-2">
                                                        <label for="inputCity">도착시간</label>
                                                        <button style="border: none; background-color: transparent" id="select-order-person">
                                                            <i class="align-middle mr-2 far fa-fw fa-clock"></i>
                                                        </button>
                                                        <input type="text" class="form-control" id="inputCity" value="{{ order.receipt_hour }}">
                                                    </div>
                                                </div>

                                                <!-- 품목 / 옵션 -->
                                                <div class="form-row">
                                                    <div class="form-group col-md-3">
                                                        <span>품목명</span>
                                                    </div>
                                                </div>
                                                <div class="card" id="item-card">
                                                    <div class="card-body">
                                                        <!-- 1번째 품목 -->
                                                        <div class="form-group row">
                                                            <button class="item-button" style="margin-left: 5px; border-color: white;
                                                background-color: #153d77; color: white">1</button>
                                                            <div class="col-md-4">
                                                                <input type="text" class="form-control" value="{{ order.product_name }}">
                                                            </div>

                                                            <!-- 옵션 결과 불러올 때, 전체 결과 조합해서 보여주기 -->
                                                            <button type="button" class="btn item-button"
                                                                    style="border-color: white;
                                                background-color: #153d77; color: white"
                                                                    data-toggle="modal" data-target="sizedModalLg{{ order.pno }}">+ 옵션추가</button>
                                                            <div class="col-md-4">
                                                                <input type="text" class="form-control"
                                                                       value="{{ order.size_option_name }}">
                                                            </div>
                                                            <div class="col-md-1" style="padding-left: 0">
                                                                <input type="number" class="form-control" value="{{ order.count }}">
                                                            </div>
                                                            <label style="padding-right: 20px;" class="col-form-label" for="">개</label>
                                                            <button class="item-button"
                                                                    style="border-color: white;
                                                background-color: darkred; color: white">X</button>
                                                        </div>
                                                        <div class="form-group row justify-content-end">
                                                            <label style="padding-left: 20px;" class="col-form-label" for="">금액</label>
                                                            <div class="col-md-4">
                                                                <input type="text" class="form-control" value="">
                                                            </div>
                                                        </div>

                                                        <!-- 상품 추가 버튼 -->
                                                        <div class="form-group row">
                                                            <button class="btn btn-block" id="add-product" style="margin-left: 50px; margin-top: 30px;
                                                 background-color: #153d77; color: white; width: 30%;">
                                                                + 상품 추가
                                                            </button>
                                                        </div>
                                                        <!-- 총 금액 표시 -->
                                                        <div class="form-group row" style="float: right; clear: both;">
                                                            <label style="padding-left: 20px;" class="col-form-label" for="">총</label>
                                                            <div class="col-md-10">
                                                                <input type="text" class="form-control" value="">
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>

                                                <!-- 결제금액 / 결제여부 / 결제방법 -->
                                                <div class="form-row">
                                                    <div class="form-group col-md-2">
                                                        <label for="inputCity">결제금액</label>
                                                        <input type="text" class="form-control" id="" value="{{ order.total_price }}">
                                                    </div>
                                                    <div class="col-md-6" style="margin-bottom: 16px;">
                                                        <label for="inputCity">결제여부</label>
                                                        <div class="col-md-6" style="align-items: center;" id="radio-result">
                                                            <label class="form-check form-check-inline" style="margin-top: 8px; margin-right: 30px;">
                                                                <input class="form-check-input" type="radio" name="radio_pay_check_yes" value="{{ order.pay_check }}">
                                                                <span class="form-check-label">
												완료
											</span>
                                                            </label>
                                                            <label class="form-check form-check-inline">
                                                                <input class="form-check-input" type="radio" name="radio_pay_check_no" value="{{ order.pay_check }}">
                                                                <span class="form-check-label">
												미완료
											</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group col-md-4" style="margin-left: -200px;">
                                                        <label for="order-root">결제 방법</label>
                                                        <select class="form-control select1" data-toggle="select1">
                                                            {% for pay in pay_table %}
                                                                {% if pay.pay_type_name == order.pay_type_name %}
                                                                    <option value="{{ pay.pay_type_name }}" selected>{{ order.pay_type_name }}</option>
                                                                {% else %}
                                                                    <option value="{{ pay.pay_type_name }}">{{ pay.pay_type_name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                                <!-- 동일인 체크 버튼 -->
                                                <div class="form-row" style="margin-top: 20px;">
                                                    <div class="form-inline">
                                                        <div class="custom-control custom-checkbox mb-1 mr-sm-2">
                                                            <input type="checkbox" class="custom-control-input" id="customControlInline">
                                                            <label class="custom-control-label" for="customControlInline"
                                                                   style="color: darkgray; font-size: 13px;">주문 고객과 동일인</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 수령인명 / 수령인 연락처 -->
                                                <div class="form-row" style="margin-top: 10px;">
                                                    <div class="form-group col-md-3">
                                                        <label for="">수령인명</label>
                                                        <input type="text" class="form-control" id="" value="{{ order.recipient }}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="">수령인 연락처</label>
                                                        <input type="text" class="form-control" id="" value="{{ order.recipient_phone }}">
                                                    </div>
                                                </div>

                                                <!-- 수령인 주소 / 우편번호 검색 -->
                                                <div class="form-group row">
                                                    <label style="padding-left: 12px;padding-right: 10px;"
                                                           class="col-form-label" for="">수령인 주소</label>
                                                    <button style="border-color: white;
                                                background-color: #0d8ddc; color: white">우편번호 검색</button>
                                                    <div class="col-md-4">
                                                        <input type="text" class="form-control" id="" value="{{ order.address1 }}">
                                                    </div>
                                                    <div class="col-md-4" style="padding-left: 0;">
                                                        <input type="text" class="form-control" id="" value="{{ order.address2 }}">
                                                    </div>
                                                </div>

                                                <!-- 주문메모 -->
                                                <div class="form-row">
                                                    <div class="form-group col-md-12">
                                                        <label class="form-label">주문메모</label>
                                                        <textarea style="width: 100%;" class="form-control" rows="5" cols="">{{ order.memo }}</textarea>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 주문 수정 / 삭제 버튼 -->
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                                <a data-uri="{% url 'list:ordermodify' %}" type="button" id="modify-order-btn{{ order.pno }}" class="btn btn-primary">수정</a>
                                <button type="button" id="delete-order-btn{{ order.pno }}" class="btn btn-danger">삭제</button>
                            </div>

                            <!-- 상태 -->
                            <input name="state" type="text" hidden="hidden" value="{{ order.state }}">
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
        <!-- END  modal -->

        <!-- Test Buttons -->
        <div class="row">
            <div class="col-12">
                <button type="button" id="test1" class="btn btn-primary" data-dismiss="modal">Date Range 테스트</button>
                <button type="button" id="test2" class="btn btn-primary" data-dismiss="modal">DataTable 테스트</button>
                <button type="button" id="test3" class="btn btn-primary" data-dismiss="modal">주문 수정 테스트</button>
                <button type="button" id="test4" class="btn btn-primary" data-dismiss="modal">주문 삭제 테스트</button>
                <button type="button" id="test5" class="btn btn-primary" data-dismiss="modal">미등록된 테스트</button>

                <div id='test6' style="border:1px solid black;margin:20px 0 0 0 ;padding:10px;"></div>

            </div>
        </div>



        <!-- *** footer *** -->
        {% include 'footer.html' %}

    </div>

    </div>

    <svg width="0" height="0" style="position:absolute">
        <defs>
            <symbol viewBox="0 0 512 512" id="ion-ios-pulse-strong">
                <path
                        d="M448 273.001c-21.27 0-39.296 13.999-45.596 32.999h-38.857l-28.361-85.417a15.999 15.999 0 0 0-15.183-10.956c-.112 0-.224 0-.335.004a15.997 15.997 0 0 0-15.049 11.588l-44.484 155.262-52.353-314.108C206.535 54.893 200.333 48 192 48s-13.693 5.776-15.525 13.135L115.496 306H16v31.999h112c7.348 0 13.75-5.003 15.525-12.134l45.368-182.177 51.324 307.94c1.229 7.377 7.397 11.92 14.864 12.344.308.018.614.028.919.028 7.097 0 13.406-3.701 15.381-10.594l49.744-173.617 15.689 47.252A16.001 16.001 0 0 0 352 337.999h51.108C409.973 355.999 427.477 369 448 369c26.511 0 48-22.492 48-49 0-26.509-21.489-46.999-48-46.999z">
                </path>
            </symbol>
        </defs>
    </svg>


{% endblock %}

{% block javascript %}

    <script src="{% static 'dist/js/app.js' %}"></script>
    <script src="{% static 'dist/js/settings.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.2.1/js/dataTables.select.min.js"></script>
    <script src="{% static 'dist/js/table_filter.js' %}"></script>
    <script src="{% static 'dist/js/bootstrap-select.js' %}"></script>

    <!-- *** 자바스크립트 *** -->
    <script>
        window.onload = function() {
            // ==============================================================================================================================================

            // === : 상위 주석
            // --- : 하위 주석
            // test code 관련해서는 'tst', 'test' 등으로 명시해놓았습니다

            // ==============================================================================================================================================


            // ==============================================================================================================================================
            // 데이터테이블 API
            // ==============================================================================================================================================
            $(function () {

                // -------------------------------------------------------
                // 한국어로 변환하는 변수 선언 (Datatable)
                // -------------------------------------------------------
                var lang_kor = {
                    "decimal": "",
                    "emptyTable": "데이터가 없습니다.",
                    "info": "_START_ - _END_ (총 _TOTAL_ 명)",
                    "infoEmpty": "0명",
                    "infoFiltered": "(전체 _MAX_ 명 중 검색결과)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "_MENU_ 개씩 보기",
                    "loadingRecords": "로딩중...",
                    "processing": "처리중...",
                    "search": "검색 : ",
                    "zeroRecords": "검색된 데이터가 없습니다.",
                    "paginate": {
                        "first": "첫 페이지",
                        "last": "마지막 페이지",
                        "next": "다음",
                        "previous": "이전"
                    },
                    "aria": {
                        "sortAscending": " :  오름차순 정렬",
                        "sortDescending": " :  내림차순 정렬"
                    }
                };

                // -------------------------------------------------------
                // Datatable 설정 및 옵션
                //
                // : 지금 설정되어 있는 옵션들은 아마 건들지 않는 것이 좋을 것 같습니다. (이래저래 바꾸다가 겹쳐져서 error 날 수 있어요)
                //   혹시 추가해야 할 부분이 있다면, 아래쪽에 추가만 하면 될 것 같습니다.
                // -------------------------------------------------------
                $('#bootstrap-table').DataTable({
                        // 한 페이지당 몇 개의 row 를 보여줄 것인지
                        pageLength: 25,
                        // excel download 버튼 관련 옵션
                        dom: 'Bfrtip',
                        buttons: [
                            {
                                extend: 'excelHtml5',
                                text: 'Excel 다운로드 <i class="align-middle far fa-fw fa-file-excel"></i>',
                                titleAttr: 'Excel',
                            }
                        ],
                        // 기본 default sorting option 관련
                        ordering: false,
                        // row 선택에 대한 옵션
                        // 현재 multi 이기 때문에 다중 선택이 가능합니다.
                        select: {
                            style: 'multi',
                        },
                        language: lang_kor,
                        sorting: true,
                        // 검색 기능
                        bFilter: false,
                        autoWidth: false,
                    },
                    function () {

                    });

                // -------------------------------------------------------
                // 데이터 테이블 Row selection 관련
                // -------------------------------------------------------
                $('#bootstrap-table').DataTable().on('key-focus', (e, dt, cell) => {
                    dt.row(cell.index().row).select();
                });

                // -------------------------------------------------------
                // 엑셀 다운로드 버튼 위치 변경
                // -------------------------------------------------------
                $('#bootstrap-table_wrapper > .dt-buttons').appendTo('.btn-group.btn-group.mb-4.align-items-center.get-excel');


                // -------------------------------------------------------
                // 데이터 row 선택하기 (multiple rows selected)
                // -------------------------------------------------------
                $('#bootstrap-table tbody tr').on('click', function () {
                    if ($(this).hasClass('selected')) {
                        $(this).removeClass('selected');
                        // $(this).toggleClass('selected');
                        //$(this).css("background-color", "#F5E6C4");

                    } else {
                        // table.$('tr.selected').removeClass('selected');
                        $(this).addClass('selected');
                        // $(this).toggleClass('selected');
                        //$(this).css("background-color", "transparent");
                    }
                });


                // -------------------------------------------------------
                // Datatable 에서 선택한 row(행) 의 data 가져오기
                // -------------------------------------------------------
                var tst = $('#bootstrap-table').DataTable().rows('.selected').data();
                /*
                $('#test2').on('click', function () {
                    console.log(tst);
                    alert(tst);
                })
                 */

                // table 변수 선언
                var table = $('#bootstrap-table').DataTable();
                var table_row = $('#bootstrap-table tbody tr.selected');

                $('#bootstrap-table tbody tr').on('click', function () {
                    if ($(this).hasClass('selected')) {
                        console.log(this);
                        let this_row = table.row(this).data();
                        let tst = $('#bootstrap-table').DataTable().rows('.selected').data();

                        // formatted variables
                        let format_pno = pno_formatting(this_row[0])
                        let format_order_num = ordernumber_formatting(this_row[1])
                        let format_date_format = date_formatting(this_row[2])
                        let format_state = order_state_formatting(this_row[3])

                        console.log('---------------look at test6 ----------------------');
                        console.log(
                            format_pno + '\n'
                            + format_order_num + '\n'
                            + format_date_format + '\n' + format_state + '\n'
                            + this_row[4] + '\n' + this_row[5] + '\n'
                            + this_row[6] + '\n' + this_row[7] + '\n' + this_row[8] + '\n'
                            + this_row[9] + '\n' + this_row[10] + '\n' + this_row[11] + '\n'
                            + this_row[12] + '\n' + this_row[13] + '\n' + this_row[14] + '\n'
                            + this_row[15] + '\n' + this_row[16] + '\n' + this_row[17] + '\n'
                            + this_row[18] + '\n' + this_row[19] + '\n' + this_row[20] + '\n'
                            + this_row[21] + '\n' + this_row[22] + '\n' + this_row[23] + '\n');

                        // Test for test2 button
                        $('#test2').on('click', function () {
                            alert(order_state_formatting(this_row[3]));
                        })


                        console.log('order_no ==== ' + this_row[1].substring(244, 258))

                        $('#test6').html("모든 데이터 : "
                            + table.row(this).data()
                            + "<br> pno :" + this_row[0]
                            + "<br> 주문번호 :" + this_row[1]
                            + "<br> 주문일자 :" + this_row[2]
                            + "<br> 진행상태 :" + this_row[3]
                            + "<br> 고객명 :" + this_row[4]
                            + "<br> 품목 :" + this_row[5]
                            + "<br> 사이즈 :" + this_row[6]
                            + "<br> 시트 :" + this_row[7]
                            + "<br> 필링 :" + this_row[8]
                            + "<br> 포장 :" + this_row[9]
                            + "<br> 문구 :" + this_row[10]
                            + "<br> 수량 :" + this_row[11]
                            + "<br> 금액 :" + this_row[12]
                            + "<br> 주문경로 :" + this_row[13]
                            + "<br> 결제방법 :" + this_row[14]
                            + "<br> 결제여부 :" + this_row[15]
                            + "<br> 수령인 :" + this_row[16]
                            + "<br> 연락처 :" + this_row[17]
                            + "<br> 수령방법 :" + this_row[18]
                            + "<br> 주소 :" + this_row[19]
                            + "<br> 상세주소 :" + this_row[20]
                            + "<br> 납품일자 :" + this_row[21]
                            + "<br> 납품시간 :" + this_row[22]
                            + "<br> 주문메모 :" + this_row[23]
                        );


                        // -------------------------------------------------------
                        // Datatable 에서 선택한 Column(열) 의 data 가져오기
                        // -------------------------------------------------------
                        var test_column = table.column(this).data();
                        var test_column_value = table.column(2, {page: 'current'}).data();
                        var column_data1 = test_column_value[0];
                        var column_data2 = test_column_value[1];
                        console.log('---------------look at test6 ----------------------');


                        // -------------------------------------------------------
                        // *** 주문 날짜 포매팅
                        // -------------------------------------------------------
                        console.log('---------------string formatting testing!!!! ----------------------');

                        var test_date = this_row[2];	// 원래 문자열
                        var regex = /[^0-9]/g;				// 숫자가 아닌 문자열을 매칭하는 정규식
                        var result = test_date.replace(regex, "");	// 원래 문자열에서 숫자가 아닌 모든 문자열을 빈 문자로 변경
                        var final_result = result.substring(0, 4) + '-' + result.substring(4, 6) + '-' + result.substring(6, 8);
                        console.log("formatted - order_date ==============" + final_result);

                        // 날짜 포매팅 함수
                        function date_formatting(d) {
                            var regex = /[^0-9]/g;
                            var temp_date = d.replace(regex, "");
                            var format_date = temp_date.substring(0, 4) + '-' + temp_date.substring(4, 6) + '-' + temp_date.substring(6, 8);

                            return format_date;
                        }

                        // -------------------------------------------------------
                        // *** 주문 번호 포매팅
                        // -------------------------------------------------------
                        var test_orderno = this_row[1];
                        var test_orderno_html = document.getElementsByClassName("order_no");

                        string = [].map.call(test_orderno_html, function (node) {
                            return node.textContent || node.innerText || "";
                        }).join("");
                        var a = Array.prototype.slice.call(document.getElementsByClassName('order_no'));

                        var test_orderno_html_0 = document.getElementsByClassName("order_no").item(0).innerHTML;
                        let formatted_order_no = test_orderno_html_0.trim();

                        console.log("formatted - order_no ==============" + formatted_order_no);

                        // 주문 번호 포매팅 함수
                        function ordernumber_formatting(n) {
                            var format_order_number = n.substring(244, 258);
                            return format_order_number;
                        }



                        // -------------------------------------------------------
                        // *** 주문 상태 포매팅
                        // -------------------------------------------------------
                        var formatted_order_state = $('#order_state').text();
                        console.log("formatted_order_state ===== " + formatted_order_state);

                        // 주문 상태 포매팅 함수
                        function order_state_formatting(state) {
                            var format_state = state.substring(51, 55);
                            return format_state;
                        }

                        // -------------------------------------------------------
                        // *** pno 포매팅
                        var a = this_row[0].substring(63);
                        var regex = /[^0-9]/g;
                        var b = a.replace(regex, "");

                        // pno 포매팅 함수
                        function pno_formatting(p) {
                            var start = p.substring(63);
                            var regex = /[^0-9]/g;
                            var format_pno = start.replace(regex, "");
                            return format_pno;
                        }


                    }
                    console.log('---------------string formatting testing!!!!----------------------');

                });


                console.log("---------------------today's test--------------------------------")

                $('#state-change').on('change', function(e){
                    var status = $(this).val();
                    $('#state-change').val(status)
                    console.log(status)
                    //table.clear().draw();
                    table.column(3).search(status).draw();

                    /*

                    if (status === "제작대상목록") {

                        // ----------------- Array : order state
                        var td_order_state = table.column(3).data();
                        //var target_one = table.column(3, {order: 'index'}).data();
                        //var target_test = table.rows( { filter: 'applied' } ).select() // 전체 선택 가능
                        var target_test = table.rows( { filter: 'applied' } ) // 전체 선택 가능

                        // ----------------- Elements : order state
                        let array_td_order_state = td_order_state.toArray();
                        for (let els of array_td_order_state) {
                            console.log(els.substring(50, 55))
                            let target_els = els.substring(50, 55)
                            if (target_els === "주문완료") {
                                table.clear().draw();
                                table.rows.add();
                                table.columns.adjust().draw();

                            }
                        }
                    }

                     */

                    /*

                    **** redraw 관련 method and test code

                    $('#upload-new-data').on('click', function () {
                        datatable.clear().draw();
                        datatable.rows.add(NewlyCreatedData); // Add new data
                        datatable.columns.adjust().draw(); // Redraw the DataTable
                    });

                     */




                    // ----------------- Array : order date
                    var td_order_date = table.column(2).data();
                    console.log(td_order_date);

                    // ----------------- Elements : order date
                    let array_td_order_date = td_order_date.toArray();
                    for (let els of array_td_order_date) {
                        console.log(els);
                    }

                })
                console.log("---------------------today's test--------------------------------")



                // -------------------------------------------------------
                // ****** row index 얻기
                // -------------------------------------------------------
                var row_index = table.row(this).index();
                var row_data = table.row(row_index).data();

                var ids = $.map(table.rows('.selected').data(), function (item) {
                    return item[row_index];
                });


                console.log('---------------each row data start ----------------------');

                // -------------------------------------------------------
                // ****** each row data 얻기
                // -------------------------------------------------------
                var data = table.data().toArray();

                data.forEach(function (row, i) {
                    row.forEach(function (column, j) {
                        //console.log('row ' + i + ' column ' + j + ' value ' + column);
                    });
                });

                console.log('---------------each row data end ----------------------');

                $('#bootstrap-table tbody').on('click', 'td', function () {
                    var cell = table.cell(this);
                    var cell_info = table.cells(".info").data();

                    var selectedrows = $('#bootstrap-table').DataTable().rows($(this).closest("tr")).data();
                    var particular = $("#bootstrap-table").DataTable().cells($(this).closest("td").siblings().eq(0)).data()
                })



            });


            // -------------------------------------------------------
            // 엑셀 필터
            // -------------------------------------------------------
            $('#bootstrap-table').excelTableFilter({
                search: true
            });

            // -------------------------------------------------------
            // 필터링 검색 기능 on
            // -------------------------------------------------------
            $('#search_input').on('keyup', function () {
                $('#bootstrap-table').search(this.value).draw();
            });



            // ==============================================================================================================================================
            // 날짜 검색 (DateRangePicker)
            // ==============================================================================================================================================
            $(function() {

                // -------------------------------------------------------
                // 날짜 검색 (2)
                // -------------------------------------------------------
                $("input[name='date_range2']").daterangepicker({
                    opens: "right",
                    locale: {
                        format: "YYYY년 MM월 DD일",
                        separator: " ~ ",
                        applyLabel: "확인",
                        cancelLabel: "취소",
                        fromLabel: "From",
                        toLabel: "To",
                        customRangeLabel: "사용자 지정",
                        weekLabel: "W",
                        daysOfWeek: ["월", "화", "수", "목", "금", "토", "일"],
                        monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
                        firstDay: 1
                    },
                    ranges: {
                        "오늘": [moment(), moment()],
                        "어제": [moment().subtract(1, "days"), moment().subtract(1, "days")],
                        "7일 전": [moment().subtract(6, "days"), moment()],
                        "30일 전": [moment().subtract(29, "days"), moment()],
                        "이번달": [moment().startOf("month"), moment().endOf("month")],
                        "지난달": [moment().subtract(1, "month").startOf("month"), moment().subtract(1, "month").endOf("month")]
                    }
                });

                // -------------------------------------------------------
                // Daterangepicker 테스트 ******
                // -------------------------------------------------------
                $('#test1').on('click', function () {
                    var alpha = $('#date_range2').data('daterangepicker').startDate.format('YYYY-MM-DD');
                    var beta = $('#date_range2').data('daterangepicker').endDate.format('YYYY-MM-DD');

                    // get start date
                    alert(alpha);

                    // get end date
                    alert(beta);

                })

            });

            // ==============================================================================================================================================
            // 주문 상세 모달
            // ==============================================================================================================================================
            $(function () {

                // CSS Work
                $(':input[readonly]').css({'background-color':'#ffffff'});

                console.log('------------여기서부터 주문 상세 모달 입니다---------');

                // 주문 상세 모달
                {% for order in orderDetail %}
                    var pno = $('input[name="pno"]').val();
                    var real_pno = "{{ order.pno }}"
                    var order_type_value = "{{ order.order_type_name }}"
                    var pay_check_value = "{{ order.pay_check }}"

                    console.log("here pno------------"+pno)
                    console.log("here realpno------------"+real_pno)

                    var option_ordertype = $("#selectbox_ordertype option:selected").val();

                    // -------------------------------------------------------
                    // 결제여부 (radio button) value 가져오기
                    // -------------------------------------------------------
                    if (pay_check_value == "O") {
                        $('input[name="radio_pay_check_yes"]').attr("checked", "checked");
                    } else if (pay_check_value == "X") {
                        $('input[name="radio_pay_check_no"]').attr("checked", "checked");
                    }

                    $.ajax({
                        type: 'GET',
                        url: '.',
                        success: function () {
                            // order_type_name
                            {#if order_type_value == option_order#}
                        },
                        error: function () {
                        }
                    });


                    // ==============================================================================================================================================
                    // 주문 수정 모달
                    // ==============================================================================================================================================
                    $('#modal' + real_pno).on('click', function () {
                        $("#sizedModalLg{{ order.pno }}").modal({show:true});
                        $.ajax({
                            type: 'GET',
                            url: '/list/orderdetail?pno=' + real_pno,
                            data: {
                                pno: real_pno,
                            },
                            success: function (data) {
                                alert("ajax is working" + "\n" + real_pno + " 그리고 " + pno
                                    + "\n" + order_type_value)
                            },
                            error: function (data, error) {
                                console.log(data)
                                console.log(error)
                                alert('got an error!')
                            }
                        })
                    });
                    console.log('------------여기까지 주문 상세 모달 입니다---------');

                    // -------------------------------------------------------
                    // 주문 수정 모달
                    // -------------------------------------------------------
                    console.log('------------여기서부터 주문 수정 모달 입니다---------');
                    $('#modify-order-btn' + real_pno).on('click', function () {
                        // 수정 버튼 클릭 시,
                        // input tag --> readonly 속성 사라짐

                        if (confirm("정말로 수정하시겠습니까?")) {
                            location.href = $(this).data('uri');
                        }
                    })

                    /*
                    $.ajax({
                    type: 'GET',
                    url: '/list/ordermodify?pno=' + real_pno,
                    data: {
                    pno: real_pno,
                    },
                    success: function (data) {
                    },
                    error: function (data, error) {
                    console.log(data)
                    console.log(error)
                    alert('got an error!')
                    }
                    });
                    */
                    console.log('------------여기까지 주문 수정 모달 입니다---------');
                {% endfor %}

            })
        }


    </script>

{% endblock javascript %}

